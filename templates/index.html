<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Snapidox — AWS Project Reporter</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    h1.section-title {
      position: relative;
      display: inline-block;
    }
    h1.section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -4px;
      width: 100%;
      height: 3px;
      background: linear-gradient(to right, #6366f1, #9333ea);
      border-radius: 9999px;
      animation: underlineExpand 0.6s ease-in-out;
    }
    @keyframes underlineExpand {
      from { width: 0; }
      to { width: 100%; }
    }

    .glow-button {
      background-color: #4f46e5;
      color: white;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      border-radius: 9999px;
      box-shadow: 0 0 0 transparent;
      transition: all 0.3s ease;
    }

    .glow-button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 18px rgba(99, 102, 241, 0.7);
      background-color: #4338ca;
    }

    .wave-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: linear-gradient(to bottom, #eef2ff 0%, #ffffff 100%);
    }

    .dark .wave-background {
      background: linear-gradient(to bottom, #1e1e2f 0%, #111827 100%);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-white to-purple-50 text-gray-800 dark:bg-gray-900 dark:text-gray-100 relative transition-colors duration-300">

  <!-- Background Gradient SVG Wave -->
  <div class="wave-background"></div>

  <!-- Dark Mode Toggle -->
  <div class="absolute top-4 right-4">
    <button id="darkModeToggle" class="px-3 py-2 text-sm rounded-full bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 transition">
      🌗 Toggle Dark Mode
    </button>
  </div>

  <!-- Loading Spinner -->
  <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-40 z-50 flex items-center justify-center hidden">
    <div class="border-4 border-white border-t-indigo-500 rounded-full w-12 h-12 animate-spin"></div>
  </div>

  <!-- Main Card -->
  <div class="min-h-screen flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 p-8 rounded-3xl shadow-2xl w-full max-w-3xl border border-gray-200 dark:border-gray-700 relative">

     
      <!-- Logo + Heading Section -->
<div class="flex flex-col items-center justify-center mb-4 space-y-2 text-center">
  <img src="{{ url_for('static', filename='logo.png') }}" alt="Snapidox Logo" class="h-16">
  <h1 class="text-3xl font-extrabold text-indigo-600">
    📄 Snapidox — AWS Project Reporter
  </h1>
  <p class="text-sm text-gray-500">Generate beautiful reports and posts using AI</p>
</div>


      <!-- Prompt Suggestions -->
      <div class="mb-6">
        <p class="text-sm font-semibold mb-2">💡 Try a sample prompt:</p>
        <div class="flex flex-wrap gap-2">
          <span class="px-3 py-1 bg-indigo-100 text-indigo-700 dark:bg-indigo-800 dark:text-indigo-200 rounded-full text-sm cursor-pointer hover:bg-indigo-200 dark:hover:bg-indigo-700 transition"
                onclick="fillPrompt(`Built a CI/CD pipeline using CodePipeline and Lambda for automating deployments.`)">
            💬 CI/CD with Lambda
          </span>
          <span class="px-3 py-1 bg-indigo-100 text-indigo-700 dark:bg-indigo-800 dark:text-indigo-200 rounded-full text-sm cursor-pointer hover:bg-indigo-200 dark:hover:bg-indigo-700 transition"
                onclick="fillPrompt(`Deployed a full-stack app using EC2, RDS, and S3 with security via IAM.`)">
            💬 Full-stack on EC2
          </span>
          <span class="px-3 py-1 bg-indigo-100 text-indigo-700 dark:bg-indigo-800 dark:text-indigo-200 rounded-full text-sm cursor-pointer hover:bg-indigo-200 dark:hover:bg-indigo-700 transition"
                onclick="fillPrompt(`Serverless image processing with S3 triggers and Lambda.`)">
            💬 Image Processing
          </span>
        </div>
      </div>

      <!-- Form -->
      <form id="reportForm" class="space-y-6">
        <div>
          <label for="prompt" class="block font-semibold">📝 Describe your AWS project:</label>
          <textarea id="prompt" rows="5"
                    class="mt-1 w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-900 focus:outline-none focus:ring focus:border-indigo-400 dark:text-gray-100"
                    placeholder="What does your AWS project do? What services did you use?"></textarea>
        </div>

        <div>
          <label for="repo_url" class="block font-semibold">🔗 GitHub Repository (optional):</label>
          <input type="url" id="repo_url"
                 class="mt-1 w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-900 focus:outline-none focus:ring focus:border-indigo-400 dark:text-gray-100"
                 placeholder="https://github.com/your-username/project-name">
        </div>

        <div class="text-center">
          <button type="submit" class="glow-button">
            🚀 Generate Report
          </button>
        </div>
      </form>
    </div>
  </div>

  <script>
    const form = document.getElementById('reportForm');
    const loadingOverlay = document.getElementById('loadingOverlay');

    form.addEventListener('submit', function (e) {
      e.preventDefault();
      loadingOverlay.classList.remove('hidden');

      const prompt = document.getElementById('prompt').value.trim();
      const github_url = document.getElementById('repo_url').value.trim();

      fetch('/generate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt, github_url })
      })
      .then(res => {
        if (!res.ok) throw new Error('Failed to generate report');
        return res.json();
      })
      .then(data => {
        sessionStorage.setItem('report', JSON.stringify(data));
        window.location.href = '/result';
      })
      .catch(err => {
        loadingOverlay.classList.add('hidden');
        alert('Something went wrong. Please try again.');
        console.error(err);
      });
    });

    function fillPrompt(text) {
      document.getElementById('prompt').value = text;
    }

    // Dark mode toggle
    const toggleBtn = document.getElementById("darkModeToggle");
    toggleBtn.addEventListener("click", () => {
      document.documentElement.classList.toggle("dark");
      localStorage.setItem("darkMode", document.documentElement.classList.contains("dark"));
    });

    // Load dark mode preference
    if (localStorage.getItem("darkMode") === "true") {
      document.documentElement.classList.add("dark");
    }
  </script>
</body>
</html>
